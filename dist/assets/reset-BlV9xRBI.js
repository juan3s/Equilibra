import"./supabaseClient-B0Gv5ww8.js";const r=window.sb,o=e=>document.getElementById(e),n=(e,t="text-slate-300")=>{const s=o("msg");s&&(s.className=`text-sm mt-2 ${t}`,s.textContent=e)};function u(){const e=new URLSearchParams(window.location.hash.replace("#",""));return{access_token:e.get("access_token"),refresh_token:e.get("refresh_token"),type:e.get("type")}}async function l(){const{data:{session:e}}=await r.auth.getSession();if(e)return e;const{access_token:t,refresh_token:s,type:i}=u();if(i==="recovery"&&t&&s){const{data:a,error:c}=await r.auth.setSession({access_token:t,refresh_token:s});return c&&console.error("setSession error:",c),a?.session||null}return null}(async function(){await l()||n("Enlace inválido o caducado. Vuelve a solicitar el restablecimiento.","text-red-400")})();o("form-new-pass")?.addEventListener("submit",async e=>{e.preventDefault();const t=o("new-pass").value,s=o("confirm-pass").value;if(t!==s)return n("Las contraseñas no coinciden.","text-amber-400");n("Actualizando contraseña…");const{data:i,error:a}=await r.auth.updateUser({password:t});if(a)return n(a.message,"text-red-400");n("¡Contraseña actualizada! Ya puedes volver a iniciar sesión.","text-emerald-400"),setTimeout(()=>window.location.href="/login.html",800)});
