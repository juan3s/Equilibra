import"./supabaseClient-B0Gv5ww8.js";const o=window.sb,e=t=>document.getElementById(t),n=(t,a)=>t.classList.toggle("hidden",!a),r=(t,a="info")=>{const s=e("toast"),i={info:"text-slate-300",ok:"text-emerald-400",warn:"text-amber-400",err:"text-red-400"};s&&(s.className=`mt-4 text-sm ${i[a]||i.info}`,s.textContent=t)},c=e("user-email");e("go-signup")?.addEventListener("click",t=>{t.preventDefault(),n(e("form-signin"),!1),n(e("form-reset"),!1),n(e("form-signup"),!0)});e("go-signin")?.addEventListener("click",t=>{t.preventDefault(),n(e("form-signin"),!0),n(e("form-reset"),!1),n(e("form-signup"),!1)});e("btn-forgot")?.addEventListener("click",()=>{n(e("form-signin"),!1),n(e("form-reset"),!0),n(e("form-signup"),!1)});e("go-back-login")?.addEventListener("click",t=>{t.preventDefault(),n(e("form-signin"),!0),n(e("form-reset"),!1),n(e("form-signup"),!1)});e("form-signin")?.addEventListener("submit",async t=>{t.preventDefault();const a=e("si-email").value.trim(),s=e("si-password").value;r("Entrando…");const{data:i,error:l}=await o.auth.signInWithPassword({email:a,password:s});if(l)return r(l.message,"err");r("¡Bienvenido!","ok"),window.location.href="/dashboard.html"});e("form-signup")?.addEventListener("submit",async t=>{t.preventDefault();const a=e("su-email").value.trim(),s=e("su-password").value;r("Creando cuenta…");const{data:i,error:l}=await o.auth.signUp({email:a,password:s,options:{emailRedirectTo:`${window.location.origin}/reset.html`}});if(l)return r(l.message,"err");r("Revisa tu correo para confirmar/restablecer.","ok"),n(e("form-signin"),!0),n(e("form-signup"),!1)});e("form-reset")?.addEventListener("submit",async t=>{t.preventDefault();const a=e("re-email").value.trim();r("Enviando enlace de restablecimiento…");const{data:s,error:i}=await o.auth.resetPasswordForEmail(a,{redirectTo:`${window.location.origin}/reset.html`});if(i)return r(i.message,"err");r("Si el email existe, se ha enviado un enlace para restablecer.","ok")});e("btn-signout")?.addEventListener("click",async()=>{await o.auth.signOut()});o.auth.onAuthStateChange(async(t,a)=>{const s=!!a;c&&(c.textContent=s?a.user?.email||"Usuario":"—"),t==="PASSWORD_RECOVERY"&&r("Abre el enlace desde tu email para restablecer la contraseña.","warn"),t==="SIGNED_IN"&&a&&(window.location.href="/dashboard.html")});(async function(){const{data:{session:a}}=await o.auth.getSession();if(a){window.location.href="/dashboard.html";return}c&&a&&(c.textContent=a.user?.email||"Usuario")})();console.log("App lista. Añade aquí la lógica post-login.");
